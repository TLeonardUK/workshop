# ================================================================================================
#  workshop
#  Copyright (C) 2022 Tim Leonard
# ================================================================================================
type: shader
version: 1

# This effect s used to calculate light probe diffuse + visibility using raytracing.

imports: [ data:shaders/common.yaml ]

effects:
  calculate_probe_rt:
    techniques:
      calculate_probe_rt: {}
   
render_states:
  calculate_probe_render_state:
    max_rt_payload_size: 48 

param_blocks:
  calculate_probe_rt_parameters:
    scope: draw
    fields:
      scene_tlas: tlas

techniques:
  calculate_probe_rt:
    ray_generation_shader: 
      file: data:shaders/source/calculate_probe_rt.hlsl
      entry: ray_generation
    ray_closest_hit_shader: 
      file: data:shaders/source/calculate_probe_rt.hlsl
      entry: ray_closest_hit
    ray_miss_shader: 
      file: data:shaders/source/calculate_probe_rt.hlsl
      entry: ray_miss
    param_blocks: [ calculate_probe_rt_parameters  ]
    render_state: calculate_probe_render_state

  # TODO: add shader to pack to SH probe